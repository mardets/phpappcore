<?php


     class DebitCommissionController extends Controller {

			public function create() {
				//get db server
				$db = Util::getDb();
				//get the profile id to use
				//$profile = Storage::getItem('data')['profile'];
				$amount = $_POST['amount'];

				$account = Controller::findOne($db, 'account', 'pin', $_POST['pin']);

				if($account) {
					$date_profile = new DateTime();

					$dcommission = array('accountid' => $account['aid'], 'amount' => $amount,
											'status' => '', 'created' => $date_profile->format('Y-m-d H:i:s'),
					 						'edited' => $date_profile->format('Y-m-d H:i:s'));
					workflow_request($db ,'debitcommission' ,'', '',$dcommission,'SENT' );
				}
				
				
				
			}
			
			public function accept() {
				//get db server
				$db = Util::getDb();
				$aid = $_POST['accountid'];
				$dcommission = Controller::findOne($db->getDbserver(), 'debitcommission', 'accountid', $aid);
				workflow_request($db ,'debitcommission' ,'', '',$dcommission,'ACCEPTED' );
			}

			public function reject() {
				//get db server
				$db = Util::getDb();
				$aid = $_POST['accountid'];
				$dcommission = Controller::findOne($db->getDbserver(), 'debitcommission', 'accountid', $aid);
				workflow_request($db ,'debitcommission' ,'', '',$dcommission,'REJECTED' );
			}

     }

?>
